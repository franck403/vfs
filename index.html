<!DOCTYPE html>
<html>
<head>
  <title>File Explorer</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    pre {
      white-space: pre-wrap;
    }
    textarea {
      width: 100%;
      height: 300px;
    }
    button {
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>File Explorer</h1>
  <div>
    <label for="directory-input">Create a new directory:</label>
    <input type="text" id="directory-input">
    <button id="create-directory-button">Create Directory</button>
  </div>
  <div>
    <label for="file-input">Create a new file:</label>
    <input type="text" id="file-input">
    <button id="create-file-button">Create File</button>
  </div>
  <div>
    <label for="file-list">Select a file:</label>
    <select id="file-list"></select>
  </div>
  <div>
    <pre id="file-content"></pre>
    <textarea id="file-editor" disabled></textarea>
    <button id="save-button" disabled>Save</button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/browserfs/dist/browserfs.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var directoryInput = document.getElementById('directory-input');
      var createDirectoryButton = document.getElementById('create-directory-button');
      var fileInput = document.getElementById('file-input');
      var createFileButton = document.getElementById('create-file-button');
      var fileList = document.getElementById('file-list');
      var fileContent = document.getElementById('file-content');
      var fileEditor = document.getElementById('file-editor');
      var saveButton = document.getElementById('save-button');
      var fs = null;
      var currentFilePath = null;

      BrowserFS.configure({
        fs: "IndexedDB",
        options: {}
      }, function (err) {
        if (err) {
          console.log(err);
        } else {
          fs = BrowserFS.BFSRequire('fs');
          fs.mkdirSync('/', { recursive: true });
          fs.mountSync('/', { fs: 'IndexedDB' });
          fs.chdirSync('/');
          initializeRootDirectory();
          refreshFileList();
          createDirectoryButton.addEventListener('click', handleCreateDirectory);
          createFileButton.addEventListener('click', handleCreateFile);
          fileList.addEventListener('change', handleFileSelect);
          saveButton.addEventListener('click', handleSaveButtonClick);
        }
      });

      function initializeRootDirectory() {
        try {
          fs.mkdirSync('/');
        } catch (err) {
          if (err.code !== 'EEXIST') {
            console.log(err);
          }
        }
      }

      function refreshFileList() {
        var files = fs.readdirSync('/');

        fileList.innerHTML = '';
        files.forEach(function(file) {
          var option = document.createElement('option');
          option.textContent = file;
          fileList.appendChild(option);
        });
      }

      function handleCreateDirectory() {
        var directoryName = directoryInput.value;

        try {
          fs.mkdirSync(directoryName);
          console.log('Directory created!');
          refreshFileList();
        } catch (err) {
          console.log(err);
        }
      }

      function handleCreateFile() {
        var fileName = fileInput.value;

        try {
          fs.writeFileSync(fileName, '');
          console.log('File created!');
          refreshFileList();
        } catch (err) {
          console.log(err);
        }
      }

      function handleFileSelect() {
        var fileName = fileList.value;
        currentFilePath = fileName;

        try {
          var data = fs.readFileSync(fileName, 'utf8');
          fileContent.textContent = data;
          fileEditor.value = data;
          fileEditor.removeAttribute('disabled');
          saveButton.removeAttribute('disabled');
        } catch (err) {
          console.log(err);
        }
      }

      function handleSaveButtonClick() {
        var content = fileEditor.value;

        try {
          fs.writeFileSync(currentFilePath, content, 'utf8');
          console.log('File saved!');
        } catch (err) {
          console.log(err);
        }
      }
    });
  </script>
</body>
</html>
